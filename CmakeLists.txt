### Configuration
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

#
# Project Info
#
PROJECT(ocelot)
SET(EXECUTABLE_NAME ocelot)

#
# Config
#
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/lib)
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)

#
# Compiler Settings
#
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11 -Wall -Wpedantic")

IF (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
  # libev bug: https://github.com/cocaine/cocaine-framework-native/issues/8#issuecomment-37831669
  UNSET(EV_ERROR)
  # Mac OS X specific code
  MESSAGE(STATUS "Compliling for Darwin")
  SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++")
  MESSAGE(STATUS "Compliling for Darwin")
ENDIF (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")

MESSAGE(STATUS ${CMAKE_CXX_FLAGS})

#
# Project Deps
#
FIND_LIBRARY(
  EV_LIBS
  NAMES
  ev
  HINTS /usr/local/lib
  )

FIND_LIBRARY(
  MYSQLPP_LIBS
  NAMES
  mysqlpp
  HINTS /usr/local/lib
  )

FIND_LIBRARY(
  BOOST_IOSTREAMS_LIBS
  NAMES
  boost_iostreams
  HINTS /usr/local/lib
  )

FIND_LIBRARY(
  BOOST_SYSTEM_LIBS
  NAMES
  boost_system
  HINTS /usr/local/lib
  )

IF (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
  FIND_LIBRARY(
    LIBC++
    NAMES
    stdc++
    )
ENDIF (${CMAKE_SYSTEM_NAME} MATCHES "Darwin")

#
# Include
#
INCLUDE_DIRECTORIES("${PROJECT_SOURCE_DIR}/src")
INCLUDE_DIRECTORIES("/usr/local/include")

#
# Project Source and Executable
#
FILE(
  GLOB_RECURSE
  SRC_FILES
  src/*
  )

ADD_EXECUTABLE(
  ${EXECUTABLE_NAME}
  ${SRC_FILES}
  )

TARGET_LINK_LIBRARIES(
  ${EXECUTABLE_NAME}
  ${LIBRARY_NAME}
  ${EV_LIBS}
  ${MYSQLPP_LIBS}
  ${BOOST_IOSTREAMS_LIBS}
  ${BOOST_SYSTEM_LIBS}
  ${LIBC++}
  )